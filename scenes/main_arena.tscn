[gd_scene load_steps=3 format=3 uid="uid://main_arena"]

[ext_resource type="Script" path="res://scripts/main_arena.gd" id="1_maingd"]

; =============================================================================
; main_arena.tscn – Haupt-Spielszene
; Root-Node: Node2D (MainArena)
; Enthaelt: Hintergrund, ArenaGrid-Platzhalter, 2 Spieler, HUD-Layer, Kamera
;
; Kamera-Mittelpunkt: Vector2(0, 0) = Arena-Mittelpunkt
; Arena-Groesse: 32 Tiles x 32px = 1024x1024 px (Tiles zentriert um 0,0)
; Daher: linke obere Ecke bei (-512, -512), rechte untere bei (512, 512)
; =============================================================================

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_top"]
size = Vector2(1200, 32)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_bottom"]
size = Vector2(1200, 32)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_left"]
size = Vector2(32, 1024)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_right"]
size = Vector2(32, 1024)

[node name="MainArena" type="Node2D"]
script = ExtResource("1_maingd")

; --- Hintergrund ---
; Dunkles Obsidian-Blau gemaess Moodboard 01 (Arcane Foundry).
; Groesse: 1920x1080 zentriert um (0,0) -> Position (-960,-540)
[node name="Background" type="ColorRect" parent="."]
offset_left = -960.0
offset_top = -540.0
offset_right = 960.0
offset_bottom = 540.0
color = Color(0.027, 0.027, 0.067, 1.0)
z_index = -10

; --- Arena-Boden ---
; Etwas hellere Flaeche als Spielbereich-Markierung (32x32 Tiles = 1024x1024 px)
[node name="ArenaFloor" type="ColorRect" parent="."]
offset_left = -512.0
offset_top = -512.0
offset_right = 512.0
offset_bottom = 512.0
color = Color(0.05, 0.05, 0.1, 1.0)
z_index = -9

; --- Runen-Risse (Atmosphaere) ---
; Duenne emissive Linien im Boden. Langsames Pulsieren kommt in Phase 4 (VFX).
; Hier nur statische Linien als Platzhalter fuer das Grundlayout.
[node name="RuneLines" type="Node2D" parent="."]
z_index = -8

[node name="RuneLine_H1" type="Line2D" parent="RuneLines"]
points = PackedVector2Array(-500, 0, 500, 0)
width = 1.5
default_color = Color(0.2, 0.4, 1.0, 0.6)

[node name="RuneLine_V1" type="Line2D" parent="RuneLines"]
points = PackedVector2Array(0, -500, 0, 500)
width = 1.5
default_color = Color(0.5, 0.1, 1.0, 0.6)

[node name="RuneLine_Diag1" type="Line2D" parent="RuneLines"]
points = PackedVector2Array(-400, -400, 400, 400)
width = 1.0
default_color = Color(0.2, 0.4, 1.0, 0.35)

[node name="RuneLine_Diag2" type="Line2D" parent="RuneLines"]
points = PackedVector2Array(400, -400, -400, 400)
width = 1.0
default_color = Color(0.5, 0.1, 1.0, 0.35)

; --- Arena-Waende (Physics-Layer 4 = ArenaWaende) ---
; StaticBody2D mit CollisionShape2D. Spieler koennen nicht hindurchgehen.
; call_deferred wird NICHT benoetigt da Waende nie deaktiviert werden.
[node name="Walls" type="Node2D" parent="."]

[node name="WallTop" type="StaticBody2D" parent="Walls"]
position = Vector2(0, -528)
collision_layer = 8
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Walls/WallTop"]
shape = SubResource("RectangleShape2D_wall_top")

[node name="WallVisual" type="ColorRect" parent="Walls/WallTop"]
offset_left = -600.0
offset_top = -16.0
offset_right = 600.0
offset_bottom = 16.0
color = Color(0.15, 0.15, 0.25, 1.0)

[node name="WallBottom" type="StaticBody2D" parent="Walls"]
position = Vector2(0, 528)
collision_layer = 8
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Walls/WallBottom"]
shape = SubResource("RectangleShape2D_wall_bottom")

[node name="WallVisual" type="ColorRect" parent="Walls/WallBottom"]
offset_left = -600.0
offset_top = -16.0
offset_right = 600.0
offset_bottom = 16.0
color = Color(0.15, 0.15, 0.25, 1.0)

[node name="WallLeft" type="StaticBody2D" parent="Walls"]
position = Vector2(-528, 0)
collision_layer = 8
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Walls/WallLeft"]
shape = SubResource("RectangleShape2D_wall_left")

[node name="WallVisual" type="ColorRect" parent="Walls/WallLeft"]
offset_left = -16.0
offset_top = -512.0
offset_right = 16.0
offset_bottom = 512.0
color = Color(0.15, 0.15, 0.25, 1.0)

[node name="WallRight" type="StaticBody2D" parent="Walls"]
position = Vector2(528, 0)
collision_layer = 8
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Walls/WallRight"]
shape = SubResource("RectangleShape2D_wall_right")

[node name="WallVisual" type="ColorRect" parent="Walls/WallRight"]
offset_left = -16.0
offset_top = -512.0
offset_right = 16.0
offset_bottom = 512.0
color = Color(0.15, 0.15, 0.25, 1.0)

; --- Arena-Grid-Platzhalter ---
; Wird in Phase 1 Stream D durch arena_grid.gd ersetzt der 32x32 Tiles
; instanziiert. Dieser Node ist bereits als ArenaGrid benannt damit main_arena.gd
; ihn via $ArenaGrid finden kann.
[node name="ArenaGrid" type="Node2D" parent="."]

; --- Spieler-Platzhalter ---
; Werden in Phase 1 Stream B durch echte player.tscn-Instanzen ersetzt.
; Vorab als sichtbare ColorRect-Platzhalter damit die Szene ladbar ist.
[node name="Player1Placeholder" type="ColorRect" parent="."]
offset_left = -24.0
offset_top = -24.0
offset_right = 24.0
offset_bottom = 24.0
position = Vector2(-200, 0)
color = Color(0.0, 0.831, 1.0, 1.0)

[node name="Player2Placeholder" type="ColorRect" parent="."]
offset_left = -24.0
offset_top = -24.0
offset_right = 24.0
offset_bottom = 24.0
position = Vector2(200, 0)
color = Color(1.0, 0.0, 0.502, 1.0)

; --- HUD-Layer ---
; CanvasLayer bleibt immer im Vordergrund, unabhaengig von Kamera-Zoom und -Position.
; Enthaelt das hud.tscn als Instanz (wird in Phase 1 eingebunden).
[node name="HUDLayer" type="CanvasLayer" parent="."]
layer = 10

; Platzhalter-Labels bis hud.tscn existiert
[node name="HUDPlaceholder" type="Label" parent="HUDLayer"]
offset_left = 20.0
offset_top = 20.0
offset_right = 400.0
offset_bottom = 50.0
text = "HUD – Phase 1 Platzhalter"
modulate = Color(1, 1, 1, 0.5)

; --- Kamera ---
; Startet zentriert auf Arena-Mittelpunkt (0,0).
; Phase 3 Stream B erweitert dies zu einem dynamischen CameraController.
[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(0, 0)
zoom = Vector2(1, 1)
